fix rare case of fork and deadlock
