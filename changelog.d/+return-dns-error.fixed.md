Return valid error code when dns lookup fails, instead of -1.
