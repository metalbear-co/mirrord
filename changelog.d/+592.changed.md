Improves the agent handling of background tasks by having them run in a separate tokio runtime. Also adds a timeout for waiting on these tasks to finish (timeout of 5 seconds).
